{"status":{},"contains_secrets":false,"product_version":"2.9.7","spec":{"description":"* [Lamp](http:\/\/@@{HAPROXY.address}@@)","resources":{"client_attrs":{"6f478af0-67fd-49b2-b3ac-d89f85580157":{"y":-37,"x":-158},"a36e338c-7116-40b4-890d-0cd8928da2a9":{"y":-37,"x":-158},"6e31b3ae-15e6-468b-a583-dfd531790873":{"y":22,"x":-92},"4661e347-8900-4c4a-9f82-aa50544da3e0":{"y":138.3673932788,"x":102.9405086285},"5b1a798e-dbff-4caa-9ec8-f93cc0fb8d10":{"y":190,"x":368},"271e670f-0336-42f0-a2b5-bdaa3dd2ce54":{"y":22,"x":-92},"4f326755-7cb3-4b7d-9315-aa090939a88d":{"y":279,"x":316},"7df0cc1c_deployment_cloned_0":{"y":84.3673932788,"x":118.9405086285},"9264250a-0be0-e91e-81e3-c1255d89174f":{"y":190,"x":368},"07e27d27-3a1a-71dc-a6cd-077bb127b215":{"y":-37,"x":-158},"e5f4f563-b273-4c46-87ae-bc3fd64b64a7":{"y":-37,"x":-158},"282e6725-b27d-91da-3edd-629ed70b5da7":{"y":84.3673932788,"x":118.9405086285},"03da73b4-05a7-99ff-ed1b-812a3e10fe20":{"y":84.3673932788,"x":118.9405086285},"96d6c4f8-7f6d-41c3-96e4-88516ae798a9":{"y":138.3673932788,"x":102.9405086285},"cf63f5a3-0e83-4d4a-a1d8-9dffc2eed0e6":{"y":279,"x":316},"af5307b7-1257-687a-dd89-5b469167cb45":{"y":190,"x":368},"6b887f13-6e24-4345-bc03-6c5a4ca8360f":{"y":22,"x":-92},"bd4b0c16-17a7-4f9d-a4c7-0590a65fea10":{"y":84.3673932788,"x":118.9405086285},"0fb8a665-be5b-49c7-b104-d57afe47fadc":{"y":138.3673932788,"x":102.9405086285},"94a8746a-5146-4c95-8c50-11014ee86d4a":{"y":279,"x":316},"f8bc6586-f0f4-42b6-9c9d-8762895e9a70":{"y":190,"x":368},"f8f1cf23-b1aa-4418-830e-8d8edc60326f":{"y":22,"x":-92},"0da5c583-3b2a-452f-9650-0094303fb39f":{"y":138.3673932788,"x":102.9405086285},"a767fa91-dbd9-423e-94b1-9fde581218e6":{"y":279,"x":316}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9807fe1b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"a992bd98_runbook","main_task_local_reference":{"kind":"app_task","name":"9807fe1b_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"d3ab8fc3_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4fd20db5_runbook","main_task_local_reference":{"kind":"app_task","name":"d3ab8fc3_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"bfc74f9b_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"e4dbbc0a_runbook","main_task_local_reference":{"kind":"app_task","name":"bfc74f9b_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"a5bfd22c_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0ecebc2f_runbook","main_task_local_reference":{"kind":"app_task","name":"a5bfd22c_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"208adab8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"4e962233_runbook","main_task_local_reference":{"kind":"app_task","name":"208adab8_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"APACHE_PHP","port_list":[],"tier":"","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ANSIBLE_HOST_ID","value":"","label":"","attrs":{"type":""},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}],"description":""}],"substrate_definition_list":[{"description":"","action_list":[{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"APACHE_PHP_VMware"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"01e0ee8a_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"1e5ff1df_runbook","main_task_local_reference":{"kind":"app_task","name":"01e0ee8a_dag"},"variable_list":[]},"name":"pre_action_create"},{"description":"","type":"fragment","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_substrate","name":"APACHE_PHP_VMware"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"49240789_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"0b167871_runbook","main_task_local_reference":{"kind":"app_task","name":"49240789_dag"},"variable_list":[]},"name":"post_action_delete"}],"type":"VMWARE_VM","name":"APACHE_PHP_VMware","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.ipAddressList[0]}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"CENTOS"}},"editables":{"readiness_probe":{"connection_type":true,"retries":true,"delay_secs":true,"connection_port":true,"timeout_secs":null},"create_spec":{"name":true,"drs_mode":true,"cluster":true,"host":true,"datastore":true,"storage_pod":true,"resources":{"template_nic_list":{},"nic_list":{"0":{"nic_type":true,"net_name":true}},"template_controller_list":{},"num_vcpus_per_socket":true,"num_sockets":true,"controller_list":{},"memory_size_mib":true,"guest_customization":{"customization_name":true,"cloud_init":true},"template_disk_list":{},"disk_list":{}}}},"os_type":"Linux","create_spec":{"name":"APACHE_PHP-@@{calm_array_index}@@-@@{calm_time}@@","type":"PROVISION_VMWARE_VM","drs_mode":true,"cluster":"","host":"00000000-0000-0000-0000-002590d90310","resources":{"nic_list":[{"nic_type":"vmxnet3","type":"","net_name":"key-vim.host.PortGroup-VM Network"}],"template_nic_list":[],"template_controller_list":[],"num_vcpus_per_socket":1,"num_sockets":2,"controller_list":[],"memory_size_mib":2048,"power_state":"poweron","guest_customization":{"customization_name":"","cloud_init":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{CENTOS.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']","linux_data":null,"customization_type":"GUEST_OS_LINUX","type":"","windows_data":null},"template_disk_list":[],"type":"","account_uuid":"b21a1040-272e-7883-6fc2-6540fde33392","disk_list":[]},"template":"ESX_CENTOS_76","datastore":"ds:\/\/\/vmfs\/volumes\/10519c4d-9dce45e3\/","storage_pod":"","clone_is_template":false},"variable_list":[]}],"credential_definition_list":[{"username":"centos","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"CENTOS","editables":{"username":true,"secret":true}},{"username":"admin","description":"","type":"PASSWORD","secret":{"attrs":{"is_secret_modified":false,"secret_reference":{}}},"name":"CRED_AWX"}],"package_definition_list":[{"description":"","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"AHV_CENTOS_76","version":"","options":{"type":"","name":"AHV_CENTOS_76","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"http:\/\/download.nutanix.com\/calm\/CentOS-7-x86_64-1810.qcow2","version":{"product_version":"","type":"","product_name":""},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"APACHE_PHP"}],"name":"APACHE_PHP_PACKAGE_VMware","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"APACHE_PHP_PACKAGE_VMware"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"1_AnsibleAddHost"},{"kind":"app_task","name":"2_AnsibleInstallApache"}],"name":"27550204_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"1_AnsibleAddHost"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"2_AnsibleInstallApache"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"1_AnsibleAddHost","state":"NOT_VALIDATED","attrs":{"exit_status":[],"script":"url = '@@{ANSIBLE_SERVER}@@\/api\/v2\/hosts\/'\nusername = '@@{CRED_AWX.username}@@'\npassword = '@@{CRED_AWX.secret}@@'\nheaders = {'Content-Type': 'application\/json',  'Accept':'application\/json'}\npayload = {'variables':'','name':'@@{address}@@','enabled':True,'inventory':'@@{ANSIBLE_INVENTORY_ID}@@'}\n\nr = urlreq(url, auth='BASIC', verb='POST', user=username, passwd=password, params=json.dumps(payload), headers=headers, verify=False)\n\nif r.ok:\n    resp = json.loads(r.content)\n    print 'ANSIBLE_HOST_ID={0}'.format(resp['id'])\n    exit(0)\nelse:\n    print 'Post request failed', r.content\n    exit(1)","eval_variables":["ANSIBLE_HOST_ID"],"eval_scope":"local","type":"","script_type":"static"},"timeout_secs":"0","type":"SET_VARIABLE","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"2_AnsibleInstallApache","state":"NOT_VALIDATED","attrs":{"script":"#script\nhtmlcode = \"\"\"\n@@{ANSIBLE_HTML_CODE}@@\n\"\"\"\nhtmlStringify = htmlcode.replace(\"\\n\", \"\\\\n\")\n\nurl = '@@{ANSIBLE_SERVER}@@\/api\/v2\/job_templates\/10\/launch\/'\nusername = '@@{CRED_AWX.username}@@'\npassword = '@@{CRED_AWX.secret}@@'\nheaders = {'Content-Type': 'application\/json',  'Accept':'application\/json'}\npayload = {\n    \"extra_vars\": \"{\\n \\\"html\\\": \\\"\" + htmlStringify[2:] + \"\\\"\\n}\",\n    \"limit\": \"@@{address}@@\"\n}\n\nr = urlreq(url, auth='BASIC', verb='POST', user=username, passwd=password, params=json.dumps(payload), headers=headers, verify=False)\n\nif r.ok:\n    resp = json.loads(r.content)\n    print resp\n    exit(0)\nelse:\n    print 'Post request failed', r.content\n    exit(1)\n","type":"","command_line_args":"","exit_status":[],"script_type":"static"},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"124852e5_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"27550204_dag_cloned_1"},"message_list":[],"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"APACHE_PHP_PACKAGE_VMware"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[{"kind":"app_task","name":"AnsibleRemoveHost"}],"name":"11c3b039_dag_cloned_1","state":"ACTIVE","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"APACHE_PHP"},"retries":"0","description":"","message_list":[],"child_tasks_local_reference_list":[],"name":"AnsibleRemoveHost","state":"NOT_VALIDATED","attrs":{"expected_response_params":[{"status":"SUCCESS","code":204,"type":""}],"request_body":"","headers":[],"url":"@@{ANSIBLE_SERVER}@@\/api\/v2\/hosts\/@@{ANSIBLE_HOST_ID}@@\/","response_paths":{},"retry_interval":1,"method":"DELETE","retry_count":1,"authentication":{"type":"basic_with_cred","credential_local_reference":{"kind":"app_credential","name":"CRED_AWX"}},"tls_verify":false,"content_type":"text\/html","connection_timeout":120,"type":"HTTP","proxy_type":""},"timeout_secs":"0","type":"HTTP","variable_list":[]}],"description":"","name":"afe7faff_runbook_cloned_0","state":"ACTIVE","main_task_local_reference":{"kind":"app_task","name":"11c3b039_dag_cloned_1"},"message_list":[],"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"ESX_CENTOS_76","version":"","options":{"type":"","name":"ESX_CENTOS_76","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"http:\/\/download.nutanix.com\/calm\/CentOS-7-x86_64-1810.ova","version":{"product_version":"","type":"","product_name":""},"architecture":"X86_64","type":""},"description":""},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"7df0cc1c_deployment_cloned_0","min_replicas":"2","default_replicas":"2","depends_on_list":[],"editables":{"min_replicas":true,"max_replicas":true},"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"APACHE_PHP_PACKAGE_VMware"}],"substrate_local_reference":{"kind":"app_substrate","name":"APACHE_PHP_VMware"},"variable_list":[],"description":""}],"description":"","action_list":[{"description":"This action will scale out App Server slaves by given scale out count.","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale Out App_cloned_1"}],"name":"788fce62_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"7df0cc1c_deployment_cloned_0"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale Out App_cloned_1","attrs":{"scaling_count":"@@{COUNT}@@","type":"","scaling_type":"SCALEOUT"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"8a03e7aa_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"788fce62_dag_cloned_1"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COUNT","value":"1","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false}]},"name":"ScaleOut"},{"description":"This action will scale in App Server slaves by given scale in count.","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Scale In App"}],"name":"51ca4a45_dag_cloned_1","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_blueprint_deployment","name":"7df0cc1c_deployment_cloned_0"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Scale In App","attrs":{"scaling_count":"@@{COUNT}@@","type":"","scaling_type":"SCALEIN"},"timeout_secs":"0","type":"SCALING","variable_list":[]}],"description":"","name":"5f546660_runbook_cloned_0","main_task_local_reference":{"kind":"app_task","name":"51ca4a45_dag_cloned_1"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"COUNT","value":"1","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false}]},"name":"ScaleIn"},{"description":"This action will take mysql backup.","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"ffe62113_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"de85b27a_runbook","main_task_local_reference":{"kind":"app_task","name":"ffe62113_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"BACKUP_FILE_PATH","value":"~\/db_backup","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false}]},"name":"DBBackup"},{"description":"This action will restore mysql db from specified file.","type":"user","critical":false,"runbook":{"task_definition_list":[{"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"4c1d8f71_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"62da32d6_runbook","main_task_local_reference":{"kind":"app_task","name":"4c1d8f71_dag"},"variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"RESTORE_FILE_PATH","value":"~\/db_backup\/db_dump.sql.gz","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false}]},"name":"DBRestore"}],"name":"VMware","variable_list":[{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ANSIBLE_SERVER","value":"http:\/\/aws.10.55.30.58.nip.io:31123","label":"","attrs":{"type":""},"editables":{"value":false},"is_hidden":true,"options":{"type":"PREDEFINED","choices":[]}},{"val_type":"STRING","is_mandatory":false,"description":"","data_type":"BASE","type":"LOCAL","name":"ANSIBLE_INVENTORY_ID","value":"2","label":"","attrs":{"type":""},"editables":{"value":false},"is_hidden":true,"options":{"type":"PREDEFINED","choices":[]}},{"regex":{"should_validate":false,"value":"^(.|\\n)*$"},"val_type":"MULTILINE_STRING","is_mandatory":true,"description":"","data_type":"BASE","type":"LOCAL","name":"ANSIBLE_HTML_CODE","value":"<html>\n<h1>Hello Calm?<\/h1>\n<\/html>","label":"","attrs":{"type":""},"editables":{"value":true},"is_hidden":false,"options":{"type":"PREDEFINED","choices":[]}}]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"CENTOS"},"type":"USER"},"name":"ansible-integration"},"api_version":"3.0","metadata":{"last_update_time":"1580863186687244","kind":"blueprint","spec_version":31,"creation_time":"1580805329766974","categories":{"AppFamily":"DevOps"},"name":"ansible-integration"}}